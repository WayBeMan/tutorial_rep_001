


<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>02_arrays</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="массивы-и-ссылки">Массивы и ссылки</h1>
<p>Освежим знания прошлой лекции.</p>
<pre class=" language-java"><code class="prism  language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArrayExample</span> <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">;</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Данный код выдаст ошибку компиляции, так как в Java нельзя обращаться к переменным у которых нет значения.</p>
<p>Хорошо, давайте исправим.</p>
<pre class=" language-java"><code class="prism  language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<p>Данный код выведет</p>
<pre class=" language-java"><code class="prism  language-java"><span class="token punctuation">[</span>I<span class="token annotation punctuation">@5b480cf9</span>
</code></pre>
<p>Очевидно, напрямую sout не может вывести содержимое массива. Для этого можно воспользоваться циклом.</p>
<pre class=" language-java"><code class="prism  language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>На выходе мы получим</p>
<pre><code>0 0 0 0 0 0 0 0 0 0 
</code></pre>
<p>Возникает вопрос — всегда ли мы получим 0? Разные языки придерживаются разного мнения по данному вопросу. Java говорит, что при создании массива примитивного типа <strong>все его элементы</strong> инициализируются в каком-то смысле нулями.</p>
<p>Однако не у каждого примитивного типа есть разумный ноль. К примеру <strong>boolean</strong>. У этого типа есть два значения <strong>true</strong> и <strong>false</strong>, и значением по умолчанию считается <strong>false</strong>.</p>
<p>Окэй, что будет если мы проинициализируем массив строчек?</p>
<blockquote>
<p>Предположение:  Это будет пустая строка. Однако пустая строка это не совсем простая штука. Для пустой строки компилятор должен знать что-то про тип строка, однако в Java это не так.</p>
</blockquote>
<blockquote>
<p>В Java есть только одно место в котором специально упоминается тип String особый — это то, что к нему можно прибавить все, что угодно, и это все, что угодно будет сконкатенировано.</p>
</blockquote>
<p>Для строк мы получим <strong>null</strong>. Это специальное значение, обозначающее <em>ничего</em>. Но как это работает? Дело в том, что когда у нас есть строка, это на самом деле не строка, а ссылка на строку.</p>
<p>Если у нас есть <code>String str = "sadstring"</code>,  то в этом <code>str</code> строка не хранится ни в какой форме. Она хранится в памяти, а в <code>str</code> хранится ссылка на эту память.</p>
<p>Так вот, эта ссылка может указывать на <em>ничего</em>, говорящее, что никакой ссылки на самом деле нет. Вот это <em>ничего</em> и есть <strong>null</strong>.</p>
<p>Однако сразу же возникает множество вопросов. Сможете ли вы угадать, что выведет данный код?</p>
<pre class=" language-java"><code class="prism  language-java">String<span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>  
a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>  
a<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// в args[0] передадим "hello". </span>
  
System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Спойлер, будет <code>true true false</code>. Это должно вызывать вопросы. Давайте помедитируем, почему в последнем будет не <strong>true</strong> . В первом элементе массива лежит ссылка на <code>hello</code>. И во втором элементе лежит ссылка на <code>hello</code>.  И в третьем элементе тоже.  Но некоторые из них равны, а некоторые нет. Что происходит?</p>
<ol>
<li>В <code>a[0]</code> просто лежит ссылка на <code>hello</code>. Это на самом деле константа, её положили в пулл констант.</li>
<li>Мы сказали, что <code>a[1] = a[0]</code> , поэтому оно будет указывать туда же.</li>
<li>Теперь <code>a[2]</code> . Это было <code>hello</code>, но другое. Однако, здесь произошел нетривиальный поворот — Java умеет идентифицировать строчные константы, поэтому она не будет хранить две строчные константы с одинаковым <code>hello</code>. Поэтому третий элемент указывает туда же куда и первый со вторым.</li>
<li>Четвертую ссылку взяли из аргументов командной строки. Когда мы их парсим, об этом <code>hello</code> никто не знает. Это совершенно новое <code>hello</code>, и они не совпадают.</li>
</ol>
<p>Правила сравнения в Java такие:</p>
<ul>
<li>Оператор <code>==</code> сравнивает в Java элементы как ссылки. Если ссылки указывают в одно место, то они равны, если в разные, то нет.</li>
<li>Для проверки строчек на истинное равенство по содержимому. Для этого есть метод <code>equals</code>. Он определен у всех классов, другое дело, он не у всех классов разумно работает.</li>
</ul>
<p>Итого для ссылочных типов есть два типа равенства — равенство ссылок и равенство значения.</p>
<p>У любого массива есть длина. Может ли она быть равна нулю?</p>
<pre class=" language-java"><code class="prism  language-java">String<span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>
</code></pre>
<p>Правильный ответ может, другое дело, что наша программа сломается, так как мы попытаемся залезть в невыделенную нам память и получим <strong>ArrayIndexOutOfBoundsException</strong>.</p>
<p>Также мы можем создавать массив не заранее фиксированного размера. Здесь <code>args.length</code> — не константа компиляции,.</p>
<pre class=" language-java"><code class="prism  language-java">String<span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span>args<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<p>А можем ли мы сделать так?</p>
<pre class=" language-java"><code class="prism  language-java">String<span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<p>Уже нет, так как не понятно, что такое массив с отрицательной длинной. <strong>Заметьте, что это не ошибка компиляции, так как массивы создаются во время исполнения</strong>.</p>
<p>Часто нам хочется задать массив ещё при создании. Тогда нам нужно написать так:</p>
<pre class=" language-java"><code class="prism  language-java">String<span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
	<span class="token string">"hello"</span><span class="token punctuation">,</span>
	<span class="token string">"world"</span><span class="token punctuation">,</span>
	<span class="token string">"!"</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Теперь другой вопрос. Сможем ли мы сделать так?</p>
<pre class=" language-java"><code class="prism  language-java">String<span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
	<span class="token string">"hello"</span><span class="token punctuation">,</span>
	a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token string">"!"</span><span class="token punctuation">,</span>
	args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Нельзя, так как во время создания никакая переменная <code>a</code> еще не определена.</p>
<p>Теперь посмотрим на метод <code>equals</code>. Заметим, что вот такой код выдаст <code>true false</code>.</p>
<pre class=" language-java"><code class="prism  language-java">String<span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>  
        <span class="token string">"hello"</span><span class="token punctuation">,</span>  
        null  
<span class="token punctuation">}</span><span class="token punctuation">;</span>  
System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Существующие строчки не считают себя равными не существующим. Однако какое у нас мнение у <strong>null</strong> на эту тему?</p>
<pre class=" language-java"><code class="prism  language-java">String s <span class="token operator">=</span> null<span class="token punctuation">;</span>
System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Java выдаст нам <strong>NullPointerException</strong>, так как мы пытаемся вызвать метод у <em>ничего</em>. (<em>Забавно</em>: Не смотря на то, что в Java везде используется обозначение <strong>reference</strong>, по историческим причинам это исключение называется <strong>PointerException</strong>.)</p>
<p>Дальше так как итерация по индексу для массива — это очень частое действие, то для этого было создано сокращение:</p>
<pre class=" language-java"><code class="prism  language-java"><span class="token keyword">for</span> <span class="token punctuation">(</span>String s <span class="token operator">:</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>
</code></pre>
<p>Такой синтаксис называется <code>foreach</code>.  Для массивов у нас всегда есть неявный индекс, просто в <code>s</code> всегда кладётся соответствующий элемент. В случае строчек это ссылка, в случае примитивного массива элемент.</p>
<h2 id="двумерные-массивы">Двумерные массивы</h2>
<p>В отличии от одномерных, двумерные массивы инициализируются с помощью двух пар квадратных скобочек. Как вы наверное догадались, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">n</span></span></span></span></span>-мерный массив инициализируются с помощью <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">n</span></span></span></span></span> пар.</p>
<pre class=" language-java"><code class="prism  language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ints <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
  
System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ints<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> v <span class="token operator">:</span> ints<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>
</code></pre>
<p><a href="{{"/old_index.html" | relative_url}}">01_intro reference</a></p>
</div>
</body>

</html>
